package main

import "fmt"

func main() {
	fmt.Println(magnificentSets(6, [][]int{{1, 2}, {1, 4}, {1, 5}, {2, 6}, {2, 3}, {4, 6}}))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // 4
	fmt.Println(magnificentSets(6, [][]int{}))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          // 6
	fmt.Println(magnificentSets(430, [][]int{{316, 360}, {236, 101}, {236, 100}, {282, 102}, {193, 176}, {253, 60}, {372, 42}, {223, 214}, {62, 113}, {257, 374}, {74, 289}, {368, 405}, {200, 302}, {259, 212}, {281, 101}, {91, 167}, {109, 268}, {194, 121}, {93, 412}, {11, 139}, {308, 324}, {11, 409}, {366, 110}, {366, 390}, {236, 34}, {282, 240}, {379, 199}, {93, 394}, {87, 288}, {141, 28}, {76, 49}, {146, 204}, {172, 3}, {20, 140}, {59, 240}, {203, 374}, {26, 152}, {429, 49}, {59, 289}, {74, 312}, {387, 217}, {47, 4}, {427, 19}, {130, 408}, {242, 101}, {429, 247}, {76, 1}, {248, 134}, {35, 358}, {342, 337}, {347, 337}, {106, 303}, {276, 67}, {239, 355}, {129, 284}, {291, 386}, {263, 329}, {256, 152}, {321, 114}, {279, 394}, {118, 228}, {53, 44}, {237, 104}, {210, 155}, {344, 111}, {291, 245}, {6, 400}, {90, 114}, {137, 428}, {69, 251}, {256, 32}, {50, 362}, {401, 254}, {156, 214}, {37, 192}, {146, 8}, {194, 176}, {395, 140}, {208, 107}, {18, 103}, {366, 135}, {88, 317}, {90, 294}, {335, 331}, {326, 306}, {258, 155}, {210, 3}, {185, 411}, {175, 33}, {64, 167}, {2, 125}, {88, 371}, {413, 275}, {263, 312}, {397, 142}, {90, 134}, {93, 81}, {90, 139}, {263, 396}, {257, 273}, {338, 303}, {18, 169}, {195, 44}, {232, 382}, {36, 86}, {290, 128}, {359, 180}, {258, 280}, {50, 302}, {151, 430}, {381, 84}, {239, 81}, {313, 115}, {45, 331}, {185, 408}, {53, 270}, {363, 251}, {41, 404}, {315, 337}, {71, 168}, {210, 170}, {146, 3}, {322, 135}, {76, 383}, {41, 67}, {315, 399}, {424, 105}, {83, 417}, {88, 67}, {189, 399}, {203, 214}, {384, 336}, {147, 219}, {145, 298}, {290, 272}, {342, 170}, {185, 3}, {424, 65}, {198, 340}, {209, 332}, {357, 97}, {175, 103}, {147, 181}, {195, 131}, {22, 188}, {80, 350}, {27, 360}, {112, 268}, {194, 346}, {309, 288}, {118, 402}, {315, 419}, {353, 299}, {368, 345}, {379, 46}, {378, 204}, {185, 33}, {112, 238}, {365, 296}, {300, 174}, {137, 216}, {87, 358}, {59, 179}, {93, 92}, {429, 270}, {41, 243}, {248, 81}, {413, 101}, {74, 235}, {300, 408}, {129, 360}})) // 393
}

//leetcode submit region begin(Prohibit modification and deletion)
func magnificentSets(n int, edges [][]int) int {
	for i, v := range edges {
		edges[i] = []int{v[0] - 1, v[1] - 1}
	}
	nx := make([][]int, n)
	for _, v := range edges {
		nx[v[0]] = append(nx[v[0]], v[1])
		nx[v[1]] = append(nx[v[1]], v[0])
	}
	vis := make([]bool, n)
	var dfs func(i int) []int
	dfs = func(i int) []int {
		r := []int{i}
		vis[i] = true
		for _, x := range nx[i] {
			if !vis[x] {
				r = append(r, dfs(x)...)
			}
		}
		return r
	}

	ans := 0
	for i, v := range vis {
		if !v {
			ar := dfs(i)
			t := -1

		loop:
			for _, head := range ar { // 每个连通块
				gi := 1
				m := make([]int, n)
				for i, _ := range m {
					m[i] = -1
				}

				st := []int{head}
				m[head] = 0
				for len(st) > 0 {
					ns := []int{}
					for _, v := range st {
						for _, x := range nx[v] {
							if m[x] == -1 {
								m[x] = gi
								ns = append(ns, x)
							} else if m[x] != gi-2 && m[x] != gi {
								continue loop
							}
						}
					}
					st = ns
					if len(st) > 0 {
						gi++
					}
				}
				if gi > t {
					t = gi
				}
			}

			if t == -1 {
				return -1
			}
			ans += t
		}
	}

	return ans
}

//leetcode submit region end(Prohibit modification and deletion)
